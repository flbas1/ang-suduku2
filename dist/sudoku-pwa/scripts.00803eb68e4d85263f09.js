var sudoku=function(){for(var r=["1","2","3","4","5","6","7","8","9"],n=["A","B","C","D","E","F","G","H","I"],e="123456789",t=S(n,r),u=[],o={},i={},a=0;a<r.length;a++)u.push(S(n,[r[a]]));for(a=0;a<n.length;a++)u.push(S([n[a]],r));for(var f=["ABC","DEF","GHI"],h=["123","456","789"],g=0;g<f.length;g++)for(var c=0;c<h.length;c++)u.push(S(k(f[g]),k(h[c])));for(a=0;a<t.length;a++){for(var l=t[a],v=[],s=[],x=0;x<u.length;x++){var p=u[x];if(b(p,l)){s.push(p);for(var d=0;d<p.length;d++)b(v,p[d])||p[d]===l||v.push(p[d])}}o[l]=s,i[l]=v}function m(r){var n=[];for(var e in r)n.push(e);return n}function D(r,n){y(r,n)}function q(r,n){for(var e=0;e<r.length;e++)if(!n(r[e]))return!1;return!0}function y(r,n){for(var e=[],t=0;t<r.length;t++)n.length>1?n(t,r[t])&&e.push(r[t]):n(r[t])&&e.push(r[t]);return e}function A(r){return r[Math.floor(Math.random()*r.length)]}function b(r,n){return function(r,e){for(var t=0;t<r.length;t++){var u=r[t]===n;if(u)return u}return!1}(r)}function w(r){return function(r,n){var e={};return D(r,function(r,t){e[t]=n[r]}),e}(m(r),function(r){var n=[];for(var e in r)n.push(r[e]);return n}(r))}function M(r){var n,e;n=function(r){return r},e=[],D(r,function(r){e.push(n(r))});for(var t=(r=e).length;--t;){var u=Math.floor(Math.random()*(t+1)),o=r[t];r[t]=r[u],r[u]=o}return r}function k(r){for(var n=[],e=0;e<r.length;e++)n.push(r.charAt(e));return n}function S(r,n){for(var e=[],t=0;t<r.length;t++)for(var u=0;u<n.length;u++)e.push(r[t]+n[u]);return e}function z(r,n){return function r(n,e){if((e=e||{}).chooseDigit=e.chooseDigit||"random",e.chooseSquare=e.chooseSquare||"minDigits",!1===n)return!1;if(q(t,function(r){return 1==n[r].length}))return n;var u,o=y(t,function(r){return n[r].length>1});o.sort(function(r,e){return n[r].length!=n[e].length?n[r].length-n[e].length:r<e?-1:1}),"minDigits"==e.chooseSquare?u=o[0]:"maxDigits"==e.chooseSquare?u=o[o.length-1]:"random"==e.chooseSquare&&(u=o[Math.floor(Math.random()*o.length)]);var i=k(n[u]);return"max"==e.chooseDigit?i.reverse():"random"==e.chooseDigit&&(i=M(i)),function(t,o){for(var i=0;i<t.length;i++){var a=(f=t[i],r(G(w(n),u,f),e));if(a)return a}var f;return!1}(i)}(O(r),n)}function F(r){var n="string"==typeof r?C(r):r,e=z(n,{chooseDigit:"min"}),t=z(n,{chooseDigit:"max"});if(!e||!t)throw"Failed to solve";for(var u in e)if(t[u]!=e[u])return!1;return!0}function O(r){var n={};D(t,function(r){n[r]=e});var u="string"==typeof r?C(r):r;for(var o in u)if(!G(n,o,u[o]))return!1;return n}function C(r){r=r.replace(/[^0-9\.]/g,"");for(var n={},u=0;u<t.length;u++){var o=r[u];-1!=e.indexOf(o)&&(n[t[u]]=o)}return n}function G(r,n,e){return!!q(k(r[n].replace(e,"")),function(e){return function r(n,e,t){if(-1==n[e].indexOf(t))return n;if(n[e]=n[e].replace(t,""),0==n[e].length)return!1;if(1==n[e].length){var u=n[e];if(!q(i[e],function(e){return r(n,e,u)}))return!1}for(var a=0;a<o[e].length;a++){var f=y(o[e][a],function(r){return-1!=n[r].indexOf(t)});if(0==f.length)return!1;if(1==f.length&&!G(n,f[0],t))return!1}return n}(r,n,e)})&&r}var H={solve:z,getConflicts:function(r){var n=[];for(var e in r){var t=r[e]+"";if(t&&!(t.length>1))for(var u=0;u<o[e].length;u++)for(var i=o[e][u],a=0;a<i.length;a++){var f=i[a];f!=e&&t==r[f]+""&&n.push({unit:i,errorFields:[e,f]})}}return n},getHint:function(r,n){if(!n)throw{message:"Values must be sent in"};var t=z(r),u=[];for(var a in n){var f=n[a];f&&f!==t[a]&&u.push(a)}if(u.length>0)return{type:"error",square:A(u)};var h={};for(var a in t)h[a]=e;for(var a in n){h[a]=n[a];for(var g=n[a],c=o[a],l=0;l<i[a].length;l++){var v=i[a][l];h[v]=h[v].replace(g,"")}}var s=[];for(var a in h)1!=h[a].length||n[a]||s.push(a);if(s.length>0)return{type:"squarehint",square:A(s)};var x=[];for(var a in h){var p=h[a];if(1!=p.length)for(c=o[a],l=0;l<p.length;l++)for(var d=p.charAt(l),m=0;m<c.length;m++){var D=c[m];if(q(D,function(r){return r==a||-1==h[r].indexOf(d)})){var y="box";D[0].charAt(0)==D[8].charAt(0)?y="row":D[0].charAt(1)==D[8].charAt(1)&&(y="column"),x.push({type:"unithint",unitType:y,unit:D,digit:d})}}}return x.length>0?A(x):{type:"dontknow",squares:h}},isUnique:F,generate:function(r){for(var n=(new Date).getTime(),e=function(r){return"easy"==r?35:"medium"==r?28:20}(r||"easy"),u=z({}),o=w(u),i=M(t),a=i.length,f=0;f<i.length;f++){var h=i[f];if(delete o[h],a--,function(r){for(var n in r)if(r[n].length>1)return!1;return!0}(O(o))&&F(o)||(o[h]=u[h],a++),a===e)break}var g,c=(new Date).getTime()-n;return g="Generated puzzle with "+m(o).length+" squares in "+c+"ms",H.debug&&console.log(g+"\r\n"),o},serialize:function(r){for(var n="",e=0;e<t.length;e++)n+=r[t[e]]||"x";return n.replace(/xxxxxx/g,"f").replace(/xxxxx/g,"e").replace(/xxxx/g,"d").replace(/xxx/g,"c").replace(/xx/g,"b").replace(/x/g,"a")},deserialize:function(r){var n={};r=r.replace(/f/g,"xxxxxx").replace(/e/g,"xxxxx").replace(/d/g,"xxxx").replace(/c/g,"xxx").replace(/b/g,"xx").replace(/a/g,"x");for(var e=0;e<t.length;e++)"x"!=r.charAt(e)&&(n[t[e]]=r.charAt(e));return n},debug:!1,test:O,unitList:u};return H}();if("undefined"!=typeof exports)for(var i in sudoku)exports[i]=sudoku[i];